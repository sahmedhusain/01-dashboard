import{R as g,j as e,r as m,m as c}from"./animation-vendor-BWQ_wUI_.js";import{L as C}from"./index-DIwVma_V.js";import{w as S,N as k,e as h,f as I,g as $,Y as D,v as R,_ as L,O as G}from"./ui-vendor-BusGUpMC.js";import{d as _,e as E}from"./apollo-vendor-8AJvV5pX.js";import"./react-vendor-DJG_os-6.js";const f=g.forwardRef(({className:s,...a},r)=>e.jsx("input",{className:`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${s}`,ref:r,...a}));f.displayName="Input";const j=g.forwardRef(({className:s,children:a,...r},l)=>e.jsx("select",{className:`flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 ${s}`,ref:l,...r,children:a}));j.displayName="Select";const T=E`
  query GetAuditData($userId: Int!) {
    auditsGiven: audit(where: { auditorId: { _eq: $userId } }, order_by: { createdAt: desc }) {
      id
      grade
      createdAt
      group {
        path
        members { user { login } }
      }
    }
    auditsReceived: audit(where: { group: { members: { userId: { _eq: $userId } } } }, order_by: { createdAt: desc }) {
      id
      grade
      createdAt
      auditor { login }
      group {
        path
      }
    }
  }
`,Q=({user:s})=>{const[a,r]=m.useState(""),[l,n]=m.useState("all"),[i,d]=m.useState("all"),{data:o,loading:b,error:p}=_(T,{variables:{userId:s.id}});if(b)return e.jsx(C,{});if(p)return e.jsxs("div",{children:["Error loading audit data: ",p.message]});const v=(i==="all"?[...o?.auditsGiven||[],...o?.auditsReceived||[]]:i==="given"?o?.auditsGiven||[]:o?.auditsReceived||[]).filter(t=>{const u=a.toLowerCase(),y=t.group?.path?.toLowerCase()||"",w=t.auditor?.login.toLowerCase()||"",N=t.group?.members?.map(A=>A.user.login.toLowerCase()).join(" ")||"",x=y.includes(u)||w.includes(u)||N.includes(u);return l==="all"||l==="completed"&&t.grade!==null||l==="pending"&&t.grade===null?x:!1});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(c.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[e.jsx("h1",{className:"text-4xl font-bold mb-4 text-center",children:"Audit Dashboard"}),e.jsx("p",{className:"text-white/70 text-lg text-center mb-8",children:"Manage and explore your audit history"})]}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"flex justify-center mb-8",children:e.jsxs("div",{className:"bg-white/10 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>d("all"),className:`px-4 py-2 rounded-md ${i==="all"?"bg-primary-500":""}`,children:"All Audits"}),e.jsx("button",{onClick:()=>d("given"),className:`px-4 py-2 rounded-md ${i==="given"?"bg-primary-500":""}`,children:"Audits Given"}),e.jsx("button",{onClick:()=>d("received"),className:`px-4 py-2 rounded-md ${i==="received"?"bg-primary-500":""}`,children:"Audits Received"})]})}),e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"flex flex-col sm:flex-row gap-4 items-center justify-between mb-8",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50 w-4 h-4"}),e.jsx(f,{type:"text",placeholder:"Search by project, user, or auditor...",value:a,onChange:t=>r(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"w-4 h-4 text-white/70"}),e.jsxs(j,{value:l,onChange:t=>n(t.target.value),className:"bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"pending",children:"Pending"})]})]})]}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map((t,u)=>e.jsx(F,{audit:t,index:u},t.id))})]})},F=({audit:s,index:a})=>{const[r,l]=m.useState(!1),n=s.grade!==null,i=n&&s.grade>=1,d=()=>n?i?"text-green-400 bg-green-400/20":"text-red-400 bg-red-400/20":"text-yellow-400 bg-yellow-400/20";return e.jsxs(c.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:a*.05},className:"bg-slate-800/50 backdrop-blur-lg rounded-xl p-6 border border-slate-700/50 hover:bg-slate-800/70 hover:border-slate-600/50 transition-all duration-300 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-500/20 rounded-lg flex items-center justify-center",children:e.jsx(h,{className:"w-5 h-5 text-primary-400"})}),e.jsx("div",{children:e.jsx("span",{className:"text-white font-semibold text-lg",children:s.group.path})})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-semibold uppercase tracking-wide ${d()}`,children:n?i?"Passed":"Failed":"Pending"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center",children:e.jsx(I,{className:"w-4 h-4 text-purple-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx("div",{className:"text-slate-400 text-sm",children:"Date"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${d()}`,children:n?i?e.jsx($,{className:"w-4 h-4"}):e.jsx(D,{className:"w-4 h-4"}):e.jsx(R,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:n?s.grade.toFixed(2):"N/A"}),e.jsx("div",{className:"text-slate-400 text-sm",children:"Grade"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-slate-700/50 cursor-pointer hover:bg-slate-700/30 rounded-lg p-3 transition-colors",onClick:()=>l(!r),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-500/20 rounded-lg flex items-center justify-center",children:e.jsx(h,{className:"w-4 h-4 text-primary-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:"Details"}),e.jsx("div",{className:"text-slate-400 text-sm",children:"Click to view"})]})]}),e.jsx("div",{className:"transition-transform duration-200",children:r?e.jsx(L,{className:"w-5 h-5 text-slate-400"}):e.jsx(G,{className:"w-5 h-5 text-slate-400"})})]}),r&&e.jsx(c.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 bg-slate-900/50 rounded-lg p-4 border border-slate-700/30",children:e.jsxs("div",{className:"text-sm text-slate-300",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Auditor:"})," ",s.auditor?.login||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Audited Members:"})," ",s.group?.members?.map(o=>o.user.login).join(", ")||"N/A"]})]})})]})};export{Q as default};
