import{r as p,j as e,m as n,A as F}from"./animation-vendor-BWQ_wUI_.js";import{C as P}from"./Card-boLi8-L0.js";import{R as U,b as E}from"./index-BujnE6GC.js";import{a6 as H,a7 as $,Z as z,R as O,S as D,K as I,u as G,s as J,d as L,J as Z,v as W,a8 as B,a9 as K,aa as V,ab as X,y as q,x as Q}from"./ui-vendor-bNeDgDN7.js";import"./react-vendor-DJG_os-6.js";import"./apollo-vendor-8AJvV5pX.js";const Y=()=>{const c=p.useContext(U);if(c===void 0)throw new Error("useRefresh must be used within a RefreshProvider");return c},_=({className:c="",showStats:v=!0,showAutoRefreshToggle:y=!0,compact:o=!1})=>{const{isGlobalRefreshing:i,refreshStats:d,refreshAll:b,hardRefresh:f,enableAutoRefresh:w,disableAutoRefresh:x,isAutoRefreshEnabled:h,autoRefreshInterval:j,clearCache:N,getCacheSize:C,isOnline:m,lastOnlineTime:s}=Y(),[t,r]=p.useState(!1),[a,u]=p.useState(Math.round(j/1e3)),R=()=>{h?x():w(a*1e3)},S=l=>{u(l),h&&w(l*1e3)},M=l=>l<1e3?`${l}ms`:l<6e4?`${(l/1e3).toFixed(1)}s`:`${(l/6e4).toFixed(1)}m`,k=l=>{const A=Math.round(l/1e3);if(A<60)return`${A}s`;const T=Math.round(A/60);return T<60?`${T}m`:`${Math.round(T/60)}h`};return o?e.jsxs("div",{className:`flex items-center space-x-2 ${c}`,children:[e.jsx("div",{className:"flex items-center",children:m?e.jsx(H,{className:"w-4 h-4 text-green-400"}):e.jsx($,{className:"w-4 h-4 text-red-400"})}),h&&e.jsxs("div",{className:"flex items-center text-xs text-primary-400",children:[e.jsx(z,{className:"w-3 h-3 mr-1"}),k(j)]}),e.jsx(n.button,{onClick:b,disabled:i,whileHover:{scale:1.05},whileTap:{scale:.95},className:`p-2 rounded-lg transition-all ${i?"bg-primary-500/20 text-primary-400 cursor-wait":"bg-white/10 text-white/70 hover:bg-white/20 hover:text-white"}`,children:e.jsx(O,{className:`w-4 h-4 ${i?"animate-spin":""}`})})]}):e.jsxs("div",{className:`bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20 ${c}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary-500/20",children:e.jsx(O,{className:"w-5 h-5 text-primary-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:"Data Refresh"}),e.jsxs("p",{className:"text-white/60 text-sm",children:[m?"Online":"Offline"," •",h?` Auto: ${k(j)}`:" Manual"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`p-2 rounded-lg ${m?"bg-green-500/20":"bg-red-500/20"}`,children:m?e.jsx(H,{className:"w-4 h-4 text-green-400"}):e.jsx($,{className:"w-4 h-4 text-red-400"})}),e.jsx(n.button,{onClick:()=>r(!t),whileHover:{scale:1.05},whileTap:{scale:.95},className:`p-2 rounded-lg transition-all ${t?"bg-primary-500/20 text-primary-400":"bg-white/10 text-white/70 hover:bg-white/20"}`,children:e.jsx(D,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[e.jsxs(n.button,{onClick:b,disabled:i,whileHover:{scale:1.02},whileTap:{scale:.98},className:`p-3 rounded-lg border transition-all text-left ${i?"bg-primary-500/20 border-primary-500/30 text-primary-400 cursor-wait":"bg-white/5 border-white/10 text-white hover:bg-white/10"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx(O,{className:`w-4 h-4 ${i?"animate-spin":""}`}),e.jsx("span",{className:"font-medium",children:"Refresh All"})]}),e.jsx("p",{className:"text-xs text-white/60",children:i?"Refreshing...":"Update all data"})]}),e.jsxs(n.button,{onClick:f,disabled:i,whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-3 rounded-lg border bg-white/5 border-white/10 text-white hover:bg-white/10 transition-all text-left disabled:opacity-50",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Hard Refresh"})]}),e.jsx("p",{className:"text-xs text-white/60",children:"Clear cache & refresh"})]}),y&&e.jsxs(n.button,{onClick:R,whileHover:{scale:1.02},whileTap:{scale:.98},className:`p-3 rounded-lg border transition-all text-left ${h?"bg-green-500/20 border-green-500/30 text-green-400":"bg-white/5 border-white/10 text-white hover:bg-white/10"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Auto Refresh"})]}),e.jsx("p",{className:"text-xs text-white/60",children:h?`Every ${k(j)}`:"Disabled"})]})]}),e.jsx(F,{children:t&&e.jsxs(n.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-white/10 pt-4",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Refresh Settings"]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-white/80 text-sm mb-2",children:"Auto-refresh Interval"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"range",min:"10",max:"300",step:"10",value:a,onChange:l=>S(Number(l.target.value)),className:"flex-1 h-2 bg-white/20 rounded-lg appearance-none cursor-pointer"}),e.jsxs("span",{className:"text-white/70 text-sm w-12",children:[a,"s"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/80 text-sm",children:"Cache Size"}),e.jsxs("p",{className:"text-white/60 text-xs",children:[C()," entries"]})]}),e.jsx(n.button,{onClick:N,whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-3 py-1 bg-red-500/20 text-red-400 rounded-lg text-sm hover:bg-red-500/30 transition-all",children:"Clear Cache"})]})]})}),v&&e.jsxs("div",{className:"border-t border-white/10 pt-4 mt-4",children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Refresh Statistics"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-1",children:e.jsx(J,{className:"w-4 h-4 text-blue-400"})}),e.jsx("p",{className:"text-lg font-bold text-white",children:d.totalRefreshes}),e.jsx("p",{className:"text-xs text-white/60",children:"Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-1",children:e.jsx(L,{className:"w-4 h-4 text-green-400"})}),e.jsx("p",{className:"text-lg font-bold text-white",children:d.successfulRefreshes}),e.jsx("p",{className:"text-xs text-white/60",children:"Success"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-1",children:e.jsx(Z,{className:"w-4 h-4 text-red-400"})}),e.jsx("p",{className:"text-lg font-bold text-white",children:d.failedRefreshes}),e.jsx("p",{className:"text-xs text-white/60",children:"Failed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-1",children:e.jsx(W,{className:"w-4 h-4 text-purple-400"})}),e.jsx("p",{className:"text-lg font-bold text-white",children:M(d.averageRefreshTime)}),e.jsx("p",{className:"text-xs text-white/60",children:"Avg Time"})]})]}),d.lastRefreshTime&&e.jsx("div",{className:"mt-3 text-center",children:e.jsxs("p",{className:"text-white/60 text-xs",children:["Last refresh: ",E(d.lastRefreshTime)]})}),!m&&s&&e.jsx("div",{className:"mt-3 text-center",children:e.jsxs("p",{className:"text-red-400 text-xs flex items-center justify-center",children:[e.jsx($,{className:"w-3 h-3 mr-1"}),"Last online: ",E(s)]})})]})]})},g={theme:"dark",dashboard:{compactMode:!1,showAnimations:!0,defaultTab:"dashboard",chartsEnabled:!0,tabOrder:["dashboard","piscines","leaderboard","groups","audits","checkpoints","events","export"]}},ce=({userId:c,onClose:v,defaultTabs:y=[]})=>{const[o,i]=p.useState(g),[d,b]=p.useState(!1),[f,w]=p.useState("appearance");p.useEffect(()=>{const s=localStorage.getItem(`user-preferences-${c}`);if(s)try{const t=JSON.parse(s);i({...g,...t})}catch(t){console.error("Failed to parse preferences:",t)}},[c]);const x=(s,t,r)=>{i(a=>({...a,[s]:{...a[s],[t]:r}})),b(!0)},h=()=>{localStorage.setItem(`user-preferences-${c}`,JSON.stringify(o)),b(!1),console.log("Preferences saved:",o)},j=()=>{i(g),b(!0)},N=(s,t)=>{const r=[...o.dashboard.tabOrder],[a]=r.splice(s,1);r.splice(t,0,a),x("dashboard","tabOrder",r)},C=()=>{x("dashboard","tabOrder",g.dashboard.tabOrder)},m=[{id:"appearance",label:"Appearance",icon:K},{id:"dashboard",label:"Dashboard",icon:D},{id:"data",label:"Data Refresh",icon:I}];return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(n.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"User Preferences"}),e.jsx("p",{className:"text-white/60 mt-1",children:"Customize your dashboard experience"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[d&&e.jsxs(n.button,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},onClick:h,className:"flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Save Changes"]}),e.jsx("button",{onClick:v,className:"text-white/60 hover:text-white transition-colors",children:"✕"})]})]})}),e.jsxs("div",{className:"flex h-[600px]",children:[e.jsxs("div",{className:"w-64 bg-gray-900/50 border-r border-gray-700 p-4",children:[e.jsx("nav",{className:"space-y-2",children:m.map(s=>{const t=s.icon,r=f===s.id;return e.jsxs("button",{onClick:()=>w(s.id),className:`w-full flex items-center px-3 py-2 rounded-lg text-left transition-colors ${r?"bg-primary-600 text-white":"text-white/70 hover:text-white hover:bg-white/10"}`,children:[e.jsx(t,{className:"w-5 h-5 mr-3"}),s.label]},s.id)})}),e.jsx("div",{className:"mt-8 pt-4 border-t border-gray-700",children:e.jsxs("button",{onClick:j,className:"w-full flex items-center px-3 py-2 text-white/60 hover:text-white transition-colors",children:[e.jsx(V,{className:"w-4 h-4 mr-3"}),"Reset to Defaults"]})})]}),e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[f==="appearance"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Appearance Settings"}),e.jsxs(P,{className:"p-4",children:[e.jsx("label",{className:"block text-white font-medium mb-3",children:"Theme"}),e.jsx("div",{className:"space-y-2",children:["dark","light","auto"].map(s=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"theme",value:s,checked:o.theme===s,onChange:t=>x("theme","theme",t.target.value),className:"mr-3"}),e.jsx("span",{className:"text-white/80 capitalize",children:s})]},s))})]})]}),f==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Dashboard Settings"}),e.jsx(P,{className:"p-4",children:e.jsx("div",{className:"space-y-4",children:Object.entries(o.dashboard).map(([s,t])=>s==="defaultTab"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/80 mb-2",children:"Default Tab"}),e.jsxs("select",{value:t,onChange:r=>x("dashboard",s,r.target.value),className:"w-full bg-gray-700 text-white rounded px-3 py-2",children:[e.jsx("option",{value:"dashboard",children:"Dashboard"}),e.jsx("option",{value:"piscines",children:"Piscines"}),e.jsx("option",{value:"leaderboard",children:"Leaderboard"}),e.jsx("option",{value:"groups",children:"Groups"}),e.jsx("option",{value:"audits",children:"Audits"}),e.jsx("option",{value:"checkpoints",children:"Checkpoints"}),e.jsx("option",{value:"events",children:"Events"}),e.jsx("option",{value:"export",children:"Export"})]})]},s):s==="tabOrder"?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-white/80",children:"Tab Order"}),e.jsx("button",{onClick:C,className:"text-xs text-blue-400 hover:text-blue-300 transition-colors",children:"Reset to Default"})]}),e.jsx("div",{className:"space-y-2",children:t.map((r,a)=>{const u=y.find(S=>S.id===r);if(!u)return null;const R=u.icon;return e.jsxs("div",{className:"flex items-center bg-gray-700/50 rounded px-3 py-2",children:[e.jsx(X,{className:"w-4 h-4 text-white/40 mr-2"}),e.jsx(R,{className:"w-4 h-4 text-white/60 mr-2"}),e.jsx("span",{className:"text-white/80 flex-1",children:u.label}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>a>0&&N(a,a-1),disabled:a===0,className:"p-1 text-white/40 hover:text-white/60 disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(q,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>a<t.length-1&&N(a,a+1),disabled:a===t.length-1,className:"p-1 text-white/40 hover:text-white/60 disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(Q,{className:"w-3 h-3"})})]})]},r)})})]},s):e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-white/80 capitalize",children:s.replace(/([A-Z])/g," $1").trim()}),e.jsx("input",{type:"checkbox",checked:t,onChange:r=>x("dashboard",s,r.target.checked),className:"ml-3"})]},s))})})]}),f==="data"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Data Refresh Settings"}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx("p",{className:"text-white/70 text-sm mb-4",children:"Manage data refresh settings, cache, and synchronization options."}),e.jsx(_,{showStats:!0,showAutoRefreshToggle:!0})]})]})]})]})]})})};export{ce as default};
