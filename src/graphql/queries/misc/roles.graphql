# ============================================================================
# ROLE QUERIES
# Queries for user roles and permissions
# ============================================================================

# Get all roles
query GetAllRoles {
  role(order_by: { name: asc }) {
    id
    slug
    name
    description
    createdAt
    updatedAt
  }
}

# Get role by ID
query GetRoleById($roleId: Int!) {
  role(where: { id: { _eq: $roleId } }) {
    id
    slug
    name
    description
    createdAt
    updatedAt
  }
}

# Get role by slug
query GetRoleBySlug($slug: String!) {
  role(where: { slug: { _eq: $slug } }) {
    id
    slug
    name
    description
    createdAt
    updatedAt
  }
}

# Get users with specific role
query GetUsersWithRole($roleSlug: String!, $limit: Int = 100) {
  user_role(
    where: { role: { slug: { _eq: $roleSlug } } }
    limit: $limit
  ) {
    user {
      id
      login
      firstName
      lastName
      campus
      auditRatio
      totalUp
      totalDown
      createdAt
    }
    role {
      id
      slug
      name
      description
    }
  }
}

# Get user roles
query GetUserRoles($userLogin: String!) {
  user_role(where: { user: { login: { _eq: $userLogin } } }) {
    role {
      id
      slug
      name
      description
      createdAt
      updatedAt
    }
  }
}

# Get role statistics
query GetRoleStatistics {
  role {
    id
    slug
    name
    description
    # Count of users with this role
    user_roles_aggregate {
      aggregate {
        count
      }
    }
  }
}
