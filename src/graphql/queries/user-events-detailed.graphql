# Import required fragments
#import "../fragments/user-fragments.graphql"
#import "../fragments/event-fragments.graphql"
#import "../fragments/object-fragments.graphql"
#import "../fragments/registration-fragments.graphql"

# Query for user events and registrations
query GetUserEventsDetailed($userId: Int!, $limit: Int = 50, $offset: Int = 0) {
  user(where: { id: { _eq: $userId } }) {
    id
    login

    # User events
    events(
      limit: $limit
      offset: $offset
      order_by: { event: { createdAt: desc } }
    ) {
      ...EventUserInfo
      event {
        ...EventInfo
        object {
          ...ObjectInfo
          author {
            ...UserBasicInfo
          }
        }
        registration {
          ...RegistrationInfo
          object {
            ...ObjectInfo
          }
        }
        parent {
          ...EventInfo
        }
      }
    }

    # Events aggregate
    events_aggregate {
      ...EventUserAggregateInfo
    }

    # User registrations
    registrations(
      limit: $limit
      offset: $offset
      order_by: { createdAt: desc }
    ) {
      ...RegistrationUserInfo
      registration {
        ...RegistrationInfo
        object {
          ...ObjectInfo
        }
        parent {
          ...RegistrationInfo
        }
      }
    }

    # Registrations aggregate
    registrations_aggregate {
      ...RegistrationUserAggregateInfo
    }
  }
}
